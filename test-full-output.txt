  Determining projects to restore...
  All projects are up-to-date for restore.
  HomeWidgets.Core -> /Users/alan/Documents/Projects/Blazor/HomeWidgets/HomeWidgets/src/HomeWidgets.Core/bin/Debug/net10.0/HomeWidgets.Core.dll
  HomeWidgets.Shared -> /Users/alan/Documents/Projects/Blazor/HomeWidgets/HomeWidgets/src/HomeWidgets.Shared/bin/Debug/net10.0/HomeWidgets.Shared.dll
  HomeWidgets.Infrastructure -> /Users/alan/Documents/Projects/Blazor/HomeWidgets/HomeWidgets/src/HomeWidgets.Infrastructure/bin/Debug/net10.0/HomeWidgets.Infrastructure.dll
  HomeWidgets.Api -> /Users/alan/Documents/Projects/Blazor/HomeWidgets/HomeWidgets/src/HomeWidgets.Api/bin/Debug/net10.0/HomeWidgets.Api.dll
  HomeWidgets.IntegrationTests -> /Users/alan/Documents/Projects/Blazor/HomeWidgets/HomeWidgets/tests/HomeWidgets.IntegrationTests/bin/Debug/net10.0/HomeWidgets.IntegrationTests.dll
Test run for /Users/alan/Documents/Projects/Blazor/HomeWidgets/HomeWidgets/tests/HomeWidgets.IntegrationTests/bin/Debug/net10.0/HomeWidgets.IntegrationTests.dll (.NETCoreApp,Version=v10.0)
VSTest version 18.0.1 (arm64)

Starting test execution, please wait...
A total of 1 test files matched the specified pattern.
/Users/alan/Documents/Projects/Blazor/HomeWidgets/HomeWidgets/tests/HomeWidgets.IntegrationTests/bin/Debug/net10.0/HomeWidgets.IntegrationTests.dll
[xUnit.net 00:00:00.00] xUnit.net VSTest Adapter v2.8.2+699d445a1a (64-bit .NET 10.0.1)
[xUnit.net 00:00:00.05]   Discovering: HomeWidgets.IntegrationTests
[xUnit.net 00:00:00.08]   Discovered:  HomeWidgets.IntegrationTests
[xUnit.net 00:00:00.08]   Starting:    HomeWidgets.IntegrationTests
[testcontainers.org 00:00:00.17] Connected to Docker:
  Host: unix:///var/run/docker.sock
  Server Version: 29.1.3
  Kernel Version: 6.12.54-linuxkit
  API Version: 1.52
  Operating System: Docker Desktop
  Total Memory: 3.83 GB
  Labels: 
    com.docker.desktop.address=unix:///Users/alan/Library/Containers/com.docker.docker/Data/docker-cli.sock
[testcontainers.org 00:00:00.46] Docker container 4789afc1573a created
[testcontainers.org 00:00:00.53] Start Docker container 4789afc1573a
[testcontainers.org 00:00:00.99] Wait for Docker container 4789afc1573a to complete readiness checks
[testcontainers.org 00:00:01.01] Docker container 4789afc1573a ready
[testcontainers.org 00:00:03.13] Docker container 982d7b4c93c5 created
[testcontainers.org 00:00:03.15] Start Docker container 982d7b4c93c5
[testcontainers.org 00:00:03.37] Wait for Docker container 982d7b4c93c5 to complete readiness checks
[testcontainers.org 00:00:03.38] Execute "pg_isready --host localhost --dbname homewidgets --username homewidgets" at Docker container 982d7b4c93c5
[testcontainers.org 00:00:04.59] Execute "pg_isready --host localhost --dbname homewidgets --username homewidgets" at Docker container 982d7b4c93c5
[testcontainers.org 00:00:05.70] Execute "pg_isready --host localhost --dbname homewidgets --username homewidgets" at Docker container 982d7b4c93c5
[testcontainers.org 00:00:05.80] Docker container 982d7b4c93c5 ready
fail: Microsoft.EntityFrameworkCore.Database.Command[20102]
      Failed executing DbCommand (11ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
      SELECT "MigrationId", "ProductVersion"
      FROM "__EFMigrationsHistory"
      ORDER BY "MigrationId";
info: Microsoft.EntityFrameworkCore.Migrations[20411]
      Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
info: Microsoft.EntityFrameworkCore.Migrations[20402]
      Applying migration '20260111034442_InitialCreate'.
info: Microsoft.EntityFrameworkCore.Migrations[20402]
      Applying migration '20260112160000_AddIsActiveToUserWidget'.
warn: Microsoft.AspNetCore.HttpsPolicy.HttpsRedirectionMiddleware[3]
      Failed to determine the https port for redirect.
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (16ms) [Parameters=[@normalizedEmail='?'], CommandType='Text', CommandTimeout='30']
      SELECT EXISTS (
          SELECT 1
          FROM users AS u
          WHERE u."Email" = @normalizedEmail)
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (4ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = DateTime), @p2='?', @p3='?', @p4='?' (DbType = Boolean), @p5='?', @p6='?' (DbType = DateTime)], CommandType='Text', CommandTimeout='30']
      INSERT INTO users ("Id", "CreatedAt", "DisplayName", "Email", "IsEmailVerified", "PasswordHash", "UpdatedAt")
      VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (3ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Object), @p4='?', @p5='?' (DbType = Int32), @p6='?', @p7='?' (DbType = Boolean), @p8='?', @p9='?' (DbType = DateTime)], CommandType='Text', CommandTimeout='30']
      INSERT INTO widgets ("Id", "ComponentType", "CreatedAt", "DefaultConfig", "Description", "DisplayOrder", "Icon", "IsActive", "Name", "UpdatedAt")
      VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (4ms) [Parameters=[@id='?' (DbType = Guid)], CommandType='Text', CommandTimeout='30']
      SELECT u1."Id", u1."CreatedAt", u1."DisplayName", u1."Email", u1."IsEmailVerified", u1."PasswordHash", u1."UpdatedAt", s."Id", s."Config", s."CreatedAt", s."IsActive", s."Order", s."UpdatedAt", s."UserId", s."WidgetId", s."Id0", s."ComponentType", s."CreatedAt0", s."DefaultConfig", s."Description", s."DisplayOrder", s."Icon", s."IsActive0", s."Name", s."UpdatedAt0"
      FROM (
          SELECT u."Id", u."CreatedAt", u."DisplayName", u."Email", u."IsEmailVerified", u."PasswordHash", u."UpdatedAt"
          FROM users AS u
          WHERE u."Id" = @id
          LIMIT 1
      ) AS u1
      LEFT JOIN (
          SELECT u0."Id", u0."Config", u0."CreatedAt", u0."IsActive", u0."Order", u0."UpdatedAt", u0."UserId", u0."WidgetId", w."Id" AS "Id0", w."ComponentType", w."CreatedAt" AS "CreatedAt0", w."DefaultConfig", w."Description", w."DisplayOrder", w."Icon", w."IsActive" AS "IsActive0", w."Name", w."UpdatedAt" AS "UpdatedAt0"
          FROM user_widgets AS u0
          INNER JOIN widgets AS w ON u0."WidgetId" = w."Id"
      ) AS s ON u1."Id" = s."UserId"
      ORDER BY u1."Id", s."Id"
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (1ms) [Parameters=[@p='?' (DbType = Guid)], CommandType='Text', CommandTimeout='30']
      SELECT w."Id", w."ComponentType", w."CreatedAt", w."DefaultConfig", w."Description", w."DisplayOrder", w."Icon", w."IsActive", w."Name", w."UpdatedAt"
      FROM widgets AS w
      WHERE w."Id" = @p
      LIMIT 1
info: Microsoft.EntityFrameworkCore.Database.Command[20101]
      Executed DbCommand (3ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Object), @p2='?' (DbType = DateTime), @p3='?' (DbType = Int32), @p4='?' (DbType = DateTime), @p5='?' (DbType = Guid), @p6='?' (DbType = Guid), @p8='?' (DbType = Guid), @p7='?' (DbType = DateTime)], CommandType='Text', CommandTimeout='30']
      INSERT INTO user_widgets ("Id", "Config", "CreatedAt", "Order", "UpdatedAt", "UserId", "WidgetId")
      VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6)
      RETURNING "IsActive";
      UPDATE users SET "UpdatedAt" = @p7
      WHERE "Id" = @p8;
[xUnit.net 00:00:07.14]     HomeWidgets.IntegrationTests.Widgets.AddWidgetTests.AddWidget_WithValidRequest_Returns201Created [FAIL]
[xUnit.net 00:00:07.14]       Assert.Equal() Failure: Values differ
[xUnit.net 00:00:07.14]       Expected: 9f5df101-9790-4a9f-ab01-8de784e722f9
[xUnit.net 00:00:07.14]       Actual:   83f0b6a9-5fc8-4489-95db-3fa89a3bda3a
[xUnit.net 00:00:07.14]       Stack Trace:
[xUnit.net 00:00:07.14]         /Users/alan/Documents/Projects/Blazor/HomeWidgets/HomeWidgets/tests/HomeWidgets.IntegrationTests/Widgets/AddWidgetTests.cs(71,0): at HomeWidgets.IntegrationTests.Widgets.AddWidgetTests.AddWidget_WithValidRequest_Returns201Created()
[xUnit.net 00:00:07.14]         --- End of stack trace from previous location ---
[testcontainers.org 00:00:07.00] Delete Docker container 982d7b4c93c5
[xUnit.net 00:00:07.42]   Finished:    HomeWidgets.IntegrationTests
  Failed HomeWidgets.IntegrationTests.Widgets.AddWidgetTests.AddWidget_WithValidRequest_Returns201Created [847 ms]
  Error Message:
   Assert.Equal() Failure: Values differ
Expected: 9f5df101-9790-4a9f-ab01-8de784e722f9
Actual:   83f0b6a9-5fc8-4489-95db-3fa89a3bda3a
  Stack Trace:
     at HomeWidgets.IntegrationTests.Widgets.AddWidgetTests.AddWidget_WithValidRequest_Returns201Created() in /Users/alan/Documents/Projects/Blazor/HomeWidgets/HomeWidgets/tests/HomeWidgets.IntegrationTests/Widgets/AddWidgetTests.cs:line 71
--- End of stack trace from previous location ---

Test Run Failed.
Total tests: 1
     Failed: 1
 Total time: 7.7710 Seconds
